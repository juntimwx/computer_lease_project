# üìú‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤

## ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≠

1. ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏õ‡∏∏‡πà‡∏° Grave Accent ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏≠‡∏ô
2. ‡πÄ‡∏î‡∏¥‡∏°‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á GPO ‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô profile ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤ (profile ‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô Ad ‡∏´‡∏•‡∏±‡∏Å) ‡πÄ‡∏ä‡πà‡∏ô notebook ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢ WiFi
3. ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á GPO ‡∏ó‡∏µ‡πà computer config. ‡πÅ‡∏ó‡∏ô user config ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
4. ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô script ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ô GPO ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ
5. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö run script ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

```powershell
# powershell
# ‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ Grave Accent (~) ‡πÄ‡∏õ‡πá‡∏ô hotkey ‡∏™‡∏•‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡∏õ‡πâ‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (input language)
$regPath = "HKCU:\Keyboard Layout\Toggle"
Set-ItemProperty -Path $regPath -Name "Hotkey" -Value "4" -Type String -Force
```

‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á ‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏ï‡∏≤‡∏°‡πÑ‡∏õ‡∏ó‡∏µ‡πà profile ‡πÉ‡∏´‡∏°‡πà‡πÜ ‡∏ó‡∏µ‡πà login ‡∏î‡πâ‡∏ß‡∏¢

## ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

1. ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (local profiles) ‚Äî ‡∏£‡∏±‡∏ô‡πÅ‡∏ö‡∏ö elevated ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞ NTUSER.DAT
‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß (‡πÄ‡∏ä‡πà‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤) ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÄ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô ‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÅ‡∏ö‡∏ö Admin / elevated:

```powershell
# powershell
# ‡πÅ‡∏Å‡πâ‡∏ó‡∏∏‡∏Å‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô C:\Users (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô Default, Public ‡∏Ø‡∏•‡∏Ø)
$exclude = @('Public','Default','Default User','All Users')
$users = Get-ChildItem 'C:\Users' -Directory | Where-Object { $exclude -notcontains $_.Name }

foreach ($u in $users) {
    $hivePath = Join-Path $u.FullName 'NTUSER.DAT'
    if (-not (Test-Path $hivePath)) { continue }
    $tempKey = "HKU\TempHive_$($u.Name)"
    try {
        & reg.exe load $tempKey $hivePath | Out-Null

        $base = "$tempKey\Keyboard Layout\Toggle"
        # ‡∏™‡∏£‡πâ‡∏≤‡∏á key ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
        & reg.exe add $base /f | Out-Null

        # ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
        & reg.exe add $base /v "Language Hotkey" /t REG_SZ /d "4" /f | Out-Null
        & reg.exe add $base /v "Layout Hotkey" /t REG_SZ /d "3" /f | Out-Null

        # ‡∏•‡∏ö fallback ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
        & reg.exe delete $base /v "Hotkey" /f 2>$null

    } finally {
        & reg.exe unload $tempKey | Out-Null
    }
}
```

- ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞ NTUSER.DAT ‡πÄ‡∏õ‡πá‡∏ô hive ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß, ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£, ‡πÅ‡∏•‡πâ‡∏ß unload
- ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç existing local profiles ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô

- ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï ‚Äî ‡πÅ‡∏Å‡πâ‡πÉ‡∏ô Default User
‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Default profile ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ user ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏û‡∏ß‡∏Å‡∏ô‡∏µ‡πâ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÅ‡∏£‡∏Å :

```powershell
# powershell
# ‡πÅ‡∏Å‡πâ Default user hive
$defaultHive = 'C:\Users\Default\NTUSER.DAT'
$tempKey = 'HKU\DefaultTemp'
& reg.exe load $tempKey $defaultHive

$base = "$tempKey\Keyboard Layout\Toggle"
& reg.exe add $base /f
& reg.exe add $base /v "Language Hotkey" /t REG_SZ /d "4" /f
& reg.exe add $base /v "Layout Hotkey" /t REG_SZ /d "3" /f
& reg.exe delete $base /v "Hotkey" /f 2>$null

& reg.exe unload $tempKey
```

- ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏µ‡πâ user ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏£‡∏Å
